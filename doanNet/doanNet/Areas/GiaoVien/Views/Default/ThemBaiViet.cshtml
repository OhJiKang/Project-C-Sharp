@{
    Layout = "~/Views/Shared/layoutteacher.cshtml";
}
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.8/axios.min.js" integrity="sha512-PJa3oQSLWRB7wHZ7GQ/g+qyv6r4mbuhmiDb8BjSFZ8NZ2a42oTtAq5n0ucWAwcQDlikAtkub+tPVCw4np27WCg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://code.jquery.com/jquery-3.7.1.js" crossorigin="anonymous"></script>
<script src="https://cdn.datatables.net/2.0.3/js/dataTables.js" crossorigin="anonymous"></script>
<link href="https://cdn.datatables.net/2.0.3/css/dataTables.dataTables.css" rel="stylesheet">
<style>
    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 1050;
        overflow: hidden;
        outline: 0;
    }

    .modal-dialog {
        position: relative;
        width: auto;
        max-width: 80%; /* Đặt độ rộng tối đa */
        margin: 1.75rem auto;
    }

    .modal-content {
        position: relative;
        display: flex;
        flex-direction: column;
        background-color: #fff;
        background-clip: padding-box;
        border: 1px solid rgba(0,0,0,.2);
        border-radius: .3rem;
        outline: 0;
    }

    .modal-open {
        overflow: hidden;
    }

    .modal-backdrop {
        position: fixed;
        top: 0;
        left: 0;
        z-index: 1040;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,.5);
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    .img_update:hover {
        cursor: pointer;
    }
</style>
<div class='container_body_name_input_'>
    <label class='label_name_modifier base_label_inline'>Tựa đề bài post</label>
    <input type='text' class='name_input_modifier secondary_input post_tittle_place' />
</div>
<div class='container_body_address_input_'>
    <label class='label_name_modifier base_label_inline'>Meta</label>
    <input type='text' class='name_input_modifier secondary_input meta_place' />
</div>
<div class='container_body_address_input_' style="display:flex;align-items:center">
    <label class='label_name_modifier base_label_inline' style="margin-right:24px;">Ảnh bìa</label>
    <label for="cover_image_upload">
        <img src="~/Content/upload/img/news/default.png" class="img_update" style="width: 200px; height: 200px; padding: 20px; margin: auto" />
    </label>
    <input type="file" id="cover_image_upload" accept=".png,.jpg,.jpeg" value="~/Content/upload/img/news/default.png" style="outline:none;border:none;width:200px;height:200px;display:none" />
</div>
<script>
    const fileUpload = document.querySelector("#cover_image_upload");
    fileUpload.addEventListener("change", (event) => {
        // Lấy thông tin tập tin được đăng tải
        const files = event.target.files;
        const reader = new FileReader();
        // Đọc thông tin tập tin đã được đăng tải
        reader.readAsDataURL(files[0]);
        // Lắng nghe quá trình đọc tập tin hoàn thành
        reader.addEventListener("load", (event) => {
            document.querySelector(".img_update").src = `${reader.result}`;
        });
    });
</script>
<div class='container_body_address_input_'>
    <label class='label_address_modifier base_label_inline'>Tag bài post</label>
    <input type='text' class='address_input_modifier secondary_input' disabled />
    <!-- Colored mini FAB button -->
    <button data-bs-target="#ModalChooseCategory" data-bs-toggle="modal" data-bs-dismiss="modal"
            class="mdl-button mdl-js-button mdl-button--fab mdl-button--mini-fab mdl-button--colored"
            style="background-color: #35d66c">
        <i class="fa-solid fa-plus" style="margin: 10px"></i>
    </button>
</div>
<script src="~/Areas/admin/Content/ckfinder/ckfinder.js"></script>
<script src="~/Areas/admin/Content/ckeditor/ckeditor.js"></script>

<label class='label_address_modifier base_label_inline' style="width:100%;text-align:center;margin-bottom:24px">Nội dung bài post</label>


<textarea id="editor1" class="ckeditor"></textarea>
<div class="upload-container" style="width:100%;text-align:right">
    <button class="primary-btn submit_btn" style="margin-top: 24px; margin-right: 24px"> Đăng</button>
</div>
</main>

<div class="modal fade"
     id="ModalChooseCategory"
     tabindex="-1"
     aria-labelledby="ModalAddUserLable"
     aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xs">
        <div class="modal-content p-3">
            <div class="modal-body">
                <ul>
                    <li class="category-checkbox-parents" style="text-decoration:none;display:flex;align-items:center">
                        <input class="category-checkbox" type="checkbox" />
                        <span class="badge badge-pill badge-primary" style="background-color: #1C63EE;margin-left:12px;">Primary</span>
                    </li>
                </ul>
                <div class="button_container">
                    <button class="primary-btn" style="margin-top: 24px; margin-right: 24px" data-bs-target="#ModalAddingCategory" data-bs-toggle="modal" data-bs-dismiss="modal"> Thêm thể loại </button>
                    <button class="primary-btn" style="width:150px;margin-top: 24px; margin-right: 24px"> Chọn xong thể loại </button>
                </div>

            </div>
        </div>
    </div>
</div>
<div class="modal fade"
     id="ModalAddingCategory"
     tabindex="-1"
     aria-labelledby="ModalAddUserLable"
     aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xs">
        <div class="modal-content p-3"">
            <div class="modal-header">
                <h5 class="modal-title h4" id="exampleModalFullscreenSmLabel">Thêm thể loại</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                
                    <div class='container_body_name_input_' style="margin-bottom: 12px; margin-left: 12px; margin-top: 12px;">
                        <label class='label_name_modifier base_label_inline'>Tên thể loại</label>
                        <input type='text' class='name_input_modifier secondary_input post_tittle_place' />
                    </div>
                    <div class="container_body_name_input_" style="margin-bottom:12px;margin-left:12px;margin-top:12px;">
                        <label class='label_name_modifier base_label_inline'>Màu nền</label>
                        <input type="color" class="color_place" style="width:100%" value="" />
                        <div class="hex_value" style="text-align:right">
                            <label class='label_name_modifier base_label_inline'>HEX:</label>
                            <input type="text" class="secondary_input hex_value_place" style="width:10%" />
                        </div>
                    </div>
            </div>
            <div class="modal-footer">
                <button class="primary-btn" style="margin-top: 24px; margin-right: 24px" data-bs-target="#ModalChooseCategory" data-bs-toggle="modal" data-bs-dismiss="modal"> Thêm thể loại </button>
                <button class="primary-btn" style="width:150px;margin-top: 24px; margin-right: 24px" data-bs-target="#ModalChooseCategory" data-bs-toggle="modal" data-bs-dismiss="modal"> Hủy </button>
            </div>
        </div>
        

        <script>
            $(".color_place").change((e) => {
                $(".hex_value_place").val($(e.target).val());
            });
            $(".hex_value_place").change((e) => {
                $(".color_place").val($(e.target).val());
            })
        </script>

    </div>
    @Scripts.Render("~/Areas/admin/Content/Script/JSAPI/PostAPI.js")

    <script>
        var editor = CKEDITOR.replace("editor1", { height: '600px' });
        customConfig: '~/Areas/admin/Content/ckeditor/config.js'
        /*
        public string PostTittle { get; set; }
            public string PostDetail { get; set; }

            public HttpPostedFileBase PostImage { get; set; }
            public int IDAccount { get; set; }
            public List<CategoryDTO> CategoryList { get; set; }

        */
        //CKEDITOR.instances.editor1.getData():Lay du lieu CKEditor
        $(".submit_btn").click(async () => {
            let PostImage;
            console.log(document.querySelector('#cover_image_upload').files);
            if (!document.querySelector('#cover_image_upload').files[0]) {
                PostImage = null;
            }
            else {
                PostImage = document.querySelector('#cover_image_upload').files[0];
            }
            const PostDetail = {
                PostTittle: $(".post_tittle_place").val(),
                PostDetail: CKEDITOR.instances.editor1.getData(),
                meta: $(".meta_place").val(),
                PostImage: PostImage,
                IDAccount: JSON.parse(sessionStorage.getItem("IDAccount"))
            }
            console.log(PostDetail);
            return;
            const result = postPost(PostDetail);
        })
    </script>
